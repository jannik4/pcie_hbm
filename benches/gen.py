import json
import os

import matplotlib.pyplot as plt
import numpy as np


def gen_plots():
    # Read results
    results = []
    result_files = [f for f in os.listdir("results") if f.endswith(".json")]
    for file in result_files:
        with open(os.path.join("results", file), "r") as f:
            data = json.load(f)
            results.append(data)
    results.sort(key=lambda x: x["name"])

    # TODO: Generate plots
    print(json.dumps(results, indent=2))


def gen_readme():
    content = ""

    content += "> Note: This file is auto-generated by `gen.py`. See [Run benchmarks](#run-benchmarks) for more information.\n\n"
    content += "# Benchmarks\n\n"

    content += "## Run benchmarks\n\n"
    content += """```sh
# Install dependencies
pip install -r requirements.txt

# Run benchmark for a specific design
sudo python3 bench.py <name_of_design>

# Generate plots and README
python3 gen.py
```
"""

    with open("README.md", "w") as f:
        f.write(content)


gen_plots()
gen_readme()
